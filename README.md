---
editor_options: 
  markdown: 
    wrap: 72
---

# ATAC-seq Analysis: HDAC1 in Dendritic Cell Development

## Project Overview

This project analyzes ATAC-seq data from the publication: **"The histone
deacetylase HDAC1 controls dendritic cell development and anti-tumor
immunity"** - Authors: De Sá Fernandes et al. - DOI:
10.1016/j.celrep.2024.114308 - PubMed:
<https://pubmed.ncbi.nlm.nih.gov/38829740/>

The analysis examines chromatin accessibility differences between
HDAC1-deficient and wildtype dendritic cells (cDC1 and cDC2 subsets).

## Data

-   **Source:** NCBI Sequence Read Archive (SRA)
-   **Accession:** GEO: GSE266584
-   **Samples:** 8 single-end ATAC-seq samples
    -   4 cDC1 (2 WT, 2 KO)
    -   4 cDC2 (2 WT, 2 KO)
    -   SRR28895183–SRR28895190
-   **Organism:** Mouse (*Mus musculus*)
-   **Reference genome:** mm10
-   **Assay:** Single-end ATAC-seq

------------------------------------------------------------------------

## Pipeline Overview

This project uses a modular Nextflow workflow to perform standardized
ATAC-seq preprocessing, quality control, peak calling, annotation, motif
analysis, and visualization. Differential accessibility analysis is
conducted downstream in R using DiffBind.

The Nextflow pipeline performs the following steps:

1.  **Data acquisition**\
    Raw FASTQ files are downloaded from SRA using accession IDs provided
    in a sample sheet.

2.  **Raw read quality control**\
    Read quality is assessed using **FastQC**.

3.  **Adapter trimming and filtering**\
    Nextera transposase adapters and low-quality bases are removed using
    **Trimmomatic**, following ENCODE ATAC-seq recommendations.

4.  **Genome alignment**\
    Trimmed reads are aligned to the **mm10** reference genome using
    **Bowtie2** with ATAC-seq–optimized settings.

5.  **Post-alignment processing**\
    BAM files are sorted, mitochondrial reads are removed, and alignment
    statistics are collected using **SAMtools**.

6.  **Peak calling**\
    Accessible chromatin regions are identified using **MACS3**.

7.  **ATAC-seq quality metrics**\
    ATAC-seq–specific QC metrics are computed, including:

    -   Fraction of Reads in Peaks (FRiP)
    -   TSS enrichment scores

8.  **Peak annotation**\
    Peaks are annotated to genomic features using **HOMER**.

9.  **Motif enrichment analysis**\
    Enriched transcription factor binding motifs are identified using
    **HOMER**.

10. **Signal visualization**\
    Genome-wide coverage tracks (bigWig), heatmaps, and profile plots
    are generated to visualize chromatin accessibility patterns.

11. **Summary reporting**\
    All QC outputs are aggregated using **MultiQC**.

### Downstream Analysis

Differential chromatin accessibility analysis between HDAC1 KO and WT
samples is performed **outside the Nextflow pipeline** using
**DiffBind** in R. This analysis uses peak and count data generated by
the pipeline and produces differential peak tables, volcano plots, and
summary statistics used for figure reproduction and interpretation.

------------------------------------------------------------------------

## Requirements

-   Nextflow (DSL2)
-   Conda and/or Singularity
-   R (for DiffBind and downstream analysis)

------------------------------------------------------------------------

## Directory Structure

```         
├── main.nf                  # Main Nextflow workflow
├── nextflow.config          # Configuration file
├── modules/                 # Nextflow process modules
├── envs/                    # Conda environments
├── refs/                    # Reference files
│   ├── genome.fa
│   ├── mm10.gtf
│   ├── mm10_tss_fixed.bed
│   └── mm10-blacklist.v2.bed
├── samplesheet.csv          # Sample metadata
├── analysis.Rmd             # DiffBind analysis
├── results/                 # Pipeline outputs
└── README.md
```

------------------------------------------------------------------------

## How to Run

### 1. Clone the repository

``` bash
git clone <repository-url>
cd final-project-template
```

## Prepare reference files

Download the following files into the refs/ directory:

mm10 genome FASTA

mm10 GTF annotation

ENCODE mm10 blacklist

TSS BED file

### Edit configuration

Update paths and profiles in nextflow.config as needed for your system.

## Run the pipeline

```         
nextflow run main.nf -profile conda,cluster -resume
```

## Run DiffBind analysis

After the pipeline completes, run the downstream DiffBind analysis:

## Output

Pipeline results are organized under the results/ directory:

```         
results/
├── fastqc/                 # FastQC reports
├── trimmed/                # Trimmed FASTQ files
├── bams/                   # Aligned BAM files
├── peaks/                  # MACS3 peak calls
├── diffbind/               # Differential peak tables
├── homer/annotation/             # HOMER peak annotations
├── homer/motifs/                 # HOMER motif results
├── heatmaps/               # Accessibility heatmaps
├── qc/
│   ├── frip/               # FRiP scores
│   └── tss_enrichment/     # TSS enrichment scores
└── multiqc/                # MultiQC summary report
```

### Key Results

Quality Control FRiP scores: \~0.21–0.29 (acceptable for primary immune
cells)

TSS enrichment: 14.5–18.9 (well above ENCODE threshold)

### Differential Accessibility

cDC1: 553 differentially accessible regions

cDC2: 265 differentially accessible regions

Most differential regions show gained accessibility in HDAC1 knockout
samples.

### Figure Reproduction

This analysis reproduces key results from Figures 6A–6F of the original
publication, including:

-   Heatmaps of gained and lost accessibility

-   Volcano plots of differential peaks

-   Genome browser tracks at Maged1 and Spib

### Deliverables

-   ATAC-seq processing pipeline

-   README documenting pipeline and analysis

-   RMarkdown notebook for DiffBind analysis

-   Final report
